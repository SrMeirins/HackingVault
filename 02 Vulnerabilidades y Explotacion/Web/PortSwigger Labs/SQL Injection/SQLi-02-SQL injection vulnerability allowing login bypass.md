---

id: sqli-02
title: "SQL injection vulnerability allowing login bypass"
category: "SQLi"
difficulty: "Apprentice"
tags: \[portswigger, sqli, authentication, apprentice]
date: 2025-08-17
----------------

# SQL injection vulnerability allowing login bypass

**Categor√≠a:** SQLi
**Dificultad:** Apprentice
**Fuente:** PortSwigger Web Security Academy

---

# üéØ Resumen

* **Objetivo del lab**: Acceder a la aplicaci√≥n como *administrator* mediante inyecci√≥n SQL en el formulario de login.
* **Vulnerabilidad principal**: SQL Injection en campo `username`.
* **Impacto esperado**: Bypass de autenticaci√≥n y acceso como administrador.

---

# üß≠ Reconocimiento

* **Funcionalidad analizada**: `/login` con campos `username` y `password`.
* **Comportamiento observado**: Mensajes de error distintos al introducir credenciales inv√°lidas ‚Üí posible pista de inyecci√≥n.
* **Consulta SQL sospechada**:

  ```sql
  SELECT * FROM users WHERE username = '<USER_INPUT>' AND password = '<USER_INPUT>'
  ```
* **Hip√≥tesis**: Inyectando en `username`, se puede forzar un login v√°lido sin necesidad de contrase√±a.

---

# üõ†Ô∏è Explotaci√≥n paso a paso

## Paso 1 ‚Äì Probar inyecci√≥n en username

* **Qu√© hago**: Introduzco `administrator' -- -` como usuario, y cualquier valor como contrase√±a.
* **Por qu√© funciona**: El `-- -` comenta el resto de la consulta, incluyendo la verificaci√≥n de contrase√±a.
* **Consulta resultante**:

  ```sql
  SELECT * FROM users WHERE username = 'administrator' -- -' AND password = 'cualquierpassword'
  ```
* **Evidencia**: La aplicaci√≥n inicia sesi√≥n como `administrator`.

---

# ‚úÖ PoC m√≠nima

Formulario de login:

```text
Username: administrator' -- -
Password: cualquierpassword
```

Esto logra acceso como **administrator**.

---

# üîí Defensa

* **Causas**: Concatenaci√≥n directa de entradas en la consulta SQL.
* **Detecci√≥n en logs**:

  * Intentos con `' -- -` en par√°metros de login.
  * M√∫ltiples intentos fallidos seguidos de un login exitoso sin contrase√±a real.
* **Mitigaci√≥n recomendada**:

  * Uso de *prepared statements* / parametrizaci√≥n
  * Nunca construir consultas SQL a partir de cadenas concatenadas
  * Monitorizar accesos privilegiados

---

# üìù Notas y trampas

* El comentario en SQL (`--`) requiere un espacio al final (`-- -`) para ser interpretado correctamente en algunos entornos.
* Este bypass solo funciona porque no hay validaci√≥n extra ni controles de sesi√≥n seguros.

---

# üìö Referencias

* [PortSwigger Lab ‚Äì SQL injection vulnerability allowing login bypass](https://portswigger.net/web-security/sql-injection/lab-login-bypass)
* [OWASP SQL Injection](https://owasp.org/www-community/attacks/SQL_Injection)
